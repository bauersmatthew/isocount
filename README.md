# Isocount: A basic isoform serialization tool for long-read RNA-seq data.

## Overview

Isocount is a tool designed to analyze long-read RNA-sequencing data, and
translate each read into a list of splicing features (i.e. exons and introns)
that are represented in that read.

For each read, isocount calculates a coverage score for each specified feature
of interest. The coverage score is calculated as `(# matches)/[(# matches) +
(# mistakes)]` over the length of the feature, where mistakes are insertions,
deletions, and mismatches.

To decide on which features are included and excluded in each read, an
*inclusion cutoff* and an *exclusion cutoff* are passed as parameters at
startup. Features with coverage scores above the inclusion cutoff are counted
as included, while features with coverage scores below the exclusion cutoff are
counted as excluded. If a feature meets neither of these requirements, the
whole read is designated as undecidable.

## Usage

For all outputs, there are two required inputs: a BED6 feature annotation, and
a SAM alignment. All BED records in the feature annotation must be contiguous
and non-overlapping. The SAM alignment must have been generated with support
for the `=` and `X` CIGAR operations (e.g., pass the `--sam-extended-cigar`
option to GMAP during alignment).

To generate isoform names for each read, pass the `-c | --cutoff` option to
set default inclusion and exclusion cutoffs. A table listing the most commonly
detected isoforms is sent to /dev/stdout (which links to STDOUT on modern
systems), but this target can be changed with the `-o | --table-out` option. A
table listing the detected isoform for each read ID can be generated by passing
a destination file to the `-C | --categorize` option.

Isoform names are a comma-separated list of included features, sorted by the
sense-strand start position of each feature. The ordering of features can be
reversed with the `-r | --antisense` option (e.g., if the features represent
a gene on the antisense strand). Undecidable reads are assigned the name
`(undecidable)`, and reads including no features are assigned the name
`(empty)`. To automatically remove these reads from the table providing common
isoform frequencies, use `-S | --suppress`.

To generate overall coverage score distribution info for each feature, pass a
directory name to `-d | --dist` (the directory will be created if it does not
already exist). The given directory will populated with one file for each
feature, containing a sorted list of all scores produced for that feature. If
desired, the `-D | --verbose-dists` option will cause the source read ID to be
attached to each row present in the distribution files.

## Condensed Usage (from `isocount -h`)

USAGE: 

   isocount  [-C <read-isos.tsv>] [-o <isos.tsv>] [-d <dists/>] [-D]
             [-S] [-r] [-g <pat i,e>] ...  [-c <i,e>] [--] [--version]
             [-h] <anno.bed> <alig.sam>


Where: 

   -C <read-isos.tsv>,  --categorize <read-isos.tsv>
     Categorize (serialize) each read, and output a table linking read IDs
     to isoform serializations to the given file.

   -o <isos.tsv>,  --table-out <isos.tsv>
     Output the isoform table to the given file. If not given, but --cutoff
     is given, then /dev/stdout is used.

   -d <dists/>,  --dist <dists/>
     Output the distribution of mistake ratios for each feature the given
     directory.

   -D,  --verbose-dists
     Include the source read ID in a second column for each row in the
     score distribution tables.

   -S,  --suppress
     Do not report (undecidable) and (empty) serialized isoforms.

   -r,  --antisense
     Sort features in antisense order when serializing isoforms.

   -g <pat i,e>,  --cutoff-group <pat i,e>  (accepted multiple times)
     A cutoff group. Format: 'regex inclusion,exclusion'

   -c <i,e>,  --cutoff <i,e>
     The default cutoff. Format: inclusion,exclusion

   --,  --ignore_rest
     Ignores the rest of the labeled arguments following this flag.

   --version
     Displays version information and exits.

   -h,  --help
     Displays usage information and exits.

   <anno.bed>
     (required)  The BED6 annotation.

   <alig.sam>
     (required)  The SAM alignment.


   Quickly quantify the splice isoforms present in the alignment.

